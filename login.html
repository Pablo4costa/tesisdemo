<html lang="es">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Login - Housegur</title>
<link rel="stylesheet" href="css/style.css">
</head>
<body>
<main class="container center">
<section class="card narrow">
<h2>Identificarse</h2>
<p class="muted">Ingresa con tu nombre y email para acceder.</p>
<label class="field">
<span>Nombre</span>
<input id="nombre" type="text" />
</label>
<label class="field">
<span>Email</span>
<input id="email" type="email" />
</label>
<div id="mensaje" class="muted small" style="margin-top: 8px;"></div>
<div class="actions">
<button id="btnIngresar" class="btn primary">Ingresar</button>
<a class="btn" href="propiedades.html">Ver sin identificar</a>
</div>
</section>
<footer class="muted small">Identificación demo — no segura</footer>
</main>
<script src="js/app.js"></script>
<script src="js/api.js"></script>
<script>
// Login form submission with API integration
document.getElementById('btnIngresar').addEventListener('click', async () => {
  const nombre = document.getElementById('nombre').value.trim();
  const email = document.getElementById('email').value.trim();
  const mensajeDiv = document.getElementById('mensaje');
  
  // Validate inputs
  if (!nombre || !email) {
    mensajeDiv.textContent = '⚠️ Por favor ingresa nombre y email';
    console.log('[LOGIN] Validation failed: missing fields');
    return;
  }
  
  // Show loading message
  mensajeDiv.textContent = '⏳ Iniciando sesión...';
  
  try {
    // Call API to login
    const response = await loginUser(nombre, email);
    
    if (response.status === 'ok') {
      mensajeDiv.textContent = '✅ Acceso permitido. Redirigiendo...';
      console.log('[LOGIN] Login successful, redirecting to propiedades.html');
      
      // Redirect to properties page after brief delay
      setTimeout(() => {
        window.location.href = 'propiedades.html';
      }, 800);
    } else {
      mensajeDiv.textContent = '❌ Error en la respuesta del servidor';
      console.error('[LOGIN] Unexpected response:', response);
    }
  } catch (error) {
    mensajeDiv.textContent = '❌ Error de conexión. Intenta de nuevo.';
    console.error('[LOGIN] Login failed:', error);
  }
});
</script>
</body>
</html>